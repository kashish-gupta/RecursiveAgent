%% Load all files/stat variables
R1S5ROI0 = load("Run_1_Size_5_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R2S5ROI0 = load("Run_2_Size_5_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R3S5ROI0 = load("Run_3_Size_5_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R4S5ROI0 = load("Run_4_Size_5_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R5S5ROI0 = load("Run_5_Size_5_ROI_0_DyEnd_1_DyStart_1_stats.mat");

R1S5ROI3 = load("Run_1_Size_5_ROI_3_DyEnd_1_DyStart_1_stats.mat");
R2S5ROI3 = load("Run_2_Size_5_ROI_3_DyEnd_1_DyStart_1_stats.mat");
R3S5ROI3 = load("Run_3_Size_5_ROI_3_DyEnd_1_DyStart_1_stats.mat");
R4S5ROI3 = load("Run_4_Size_5_ROI_3_DyEnd_1_DyStart_1_stats.mat");
R5S5ROI3 = load("Run_5_Size_5_ROI_3_DyEnd_1_DyStart_1_stats.mat");

R1S10ROI0 = load("Run_1_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R2S10ROI0 = load("Run_2_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R3S10ROI0 = load("Run_3_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R4S10ROI0 = load("Run_4_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R5S10ROI0 = load("Run_5_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");

R1S10ROI2 = load("Run_1_Size_10_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R2S10ROI2 = load("Run_2_Size_10_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R3S10ROI2 = load("Run_3_Size_10_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R4S10ROI2 = load("Run_4_Size_10_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R5S10ROI2 = load("Run_5_Size_10_ROI_2_DyEnd_1_DyStart_1_stats.mat");

R1S10ROI4 = load("Run_1_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R2S10ROI4 = load("Run_2_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R3S10ROI4 = load("Run_3_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R4S10ROI4 = load("Run_4_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R5S10ROI4 = load("Run_5_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");

R1S10ROI6 = load("Run_1_Size_10_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R2S10ROI6 = load("Run_2_Size_10_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R3S10ROI6 = load("Run_3_Size_10_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R4S10ROI6 = load("Run_4_Size_10_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R5S10ROI6 = load("Run_5_Size_10_ROI_6_DyEnd_1_DyStart_1_stats.mat");

R1S20ROI0 = load("Run_1_Size_20_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R2S20ROI0 = load("Run_2_Size_20_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R3S20ROI0 = load("Run_3_Size_20_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R4S20ROI0 = load("Run_4_Size_20_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R5S20ROI0 = load("Run_5_Size_20_ROI_0_DyEnd_1_DyStart_1_stats.mat");

R1S20ROI2 = load("Run_1_Size_20_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R2S20ROI2 = load("Run_2_Size_20_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R3S20ROI2 = load("Run_3_Size_20_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R4S20ROI2 = load("Run_4_Size_20_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R5S20ROI2 = load("Run_5_Size_20_ROI_2_DyEnd_1_DyStart_1_stats.mat");

R1S20ROI4 = load("Run_1_Size_20_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R2S20ROI4 = load("Run_2_Size_20_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R3S20ROI4 = load("Run_3_Size_20_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R4S20ROI4 = load("Run_4_Size_20_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R5S20ROI4 = load("Run_5_Size_20_ROI_4_DyEnd_1_DyStart_1_stats.mat");

R1S20ROI6 = load("Run_1_Size_20_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R2S20ROI6 = load("Run_2_Size_20_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R3S20ROI6 = load("Run_3_Size_20_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R4S20ROI6 = load("Run_4_Size_20_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R5S20ROI6 = load("Run_5_Size_20_ROI_6_DyEnd_1_DyStart_1_stats.mat");

%% Run1, S5. ROI 1 & 3 plots
steps = 1:length(R1S5ROI0.trainingStats.AverageReward);

figure(1)
plot(steps, R2S5ROI0.trainingStats.AverageReward, steps, R2S5ROI3.trainingStats.AverageReward)
plot(steps, R1S5ROI0.trainingStats.AverageReward, steps, R2S5ROI0.trainingStats.AverageReward, steps, R3S5ROI0.trainingStats.AverageReward, steps, R4S5ROI0.trainingStats.AverageReward, steps, R5S5ROI0.trainingStats.AverageReward)
plot(steps, R1S5ROI0.trainingStats.AverageReward, steps, R2S5ROI3.trainingStats.AverageReward)
%, steps, R3S5ROI3.trainingStats.AverageReward, steps, R4S5ROI3.trainingStats.AverageReward, steps, R5S5ROI3.trainingStats.AverageReward)

%% 
steps = 1:length(R1S20ROI0.trainingStats.AverageReward);
plot(steps, R1S20ROI0.trainingStats.AverageReward, steps, R1S20ROI2.trainingStats.AverageReward, steps, R1S20ROI4.trainingStats.AverageReward, steps, R1S20ROI6.trainingStats.AverageReward)
plot(steps, R5S10ROI0.trainingStats.AverageReward, steps, R5S10ROI2.trainingStats.AverageReward)
%% Average reward over 3 episodes.

window = 10;
for i = 1:500
    j = max(1,i-window);
    rew10(i) = mean(R1S20ROI0.trainingStats.EpisodeSteps(j:i));
    rew12(i) = mean(R1S20ROI2.trainingStats.EpisodeSteps(j:i));
    rew14(i) = mean(R1S20ROI4.trainingStats.EpisodeSteps(j:i));
    rew16(i) = mean(R1S20ROI6.trainingStats.EpisodeSteps(j:i));
end
plot(steps,rew10, steps,rew12)

%% S10
rewS10ROI0 = mean([R1S10ROI0.trainingStats.AverageReward R2S10ROI0.trainingStats.AverageReward R3S10ROI0.trainingStats.AverageReward R4S10ROI0.trainingStats.AverageReward R5S10ROI0.trainingStats.AverageReward],2);
rewS10ROI2 = mean([R1S10ROI2.trainingStats.AverageReward R2S10ROI2.trainingStats.AverageReward R3S10ROI2.trainingStats.AverageReward R4S10ROI2.trainingStats.AverageReward R5S10ROI2.trainingStats.AverageReward],2);
rewS10ROI4 = mean([R1S10ROI4.trainingStats.AverageReward R2S10ROI4.trainingStats.AverageReward R3S10ROI4.trainingStats.AverageReward R4S10ROI4.trainingStats.AverageReward R5S10ROI4.trainingStats.AverageReward],2);
rewS10ROI6 = mean([R1S10ROI6.trainingStats.AverageReward R2S10ROI6.trainingStats.AverageReward R3S10ROI6.trainingStats.AverageReward R4S10ROI6.trainingStats.AverageReward R5S10ROI6.trainingStats.AverageReward],2);

plot(steps,rewS10ROI0,steps, rewS10ROI2, steps,rewS10ROI4, steps,rewS10ROI6)

%% S20
rewS20ROI0 = mean([R1S20ROI0.trainingStats.AverageReward R2S20ROI0.trainingStats.AverageReward R3S20ROI0.trainingStats.AverageReward R4S20ROI0.trainingStats.AverageReward R5S20ROI0.trainingStats.AverageReward],2);
rewS20ROI2 = mean([R1S20ROI2.trainingStats.AverageReward R2S20ROI2.trainingStats.AverageReward R3S20ROI2.trainingStats.AverageReward R4S20ROI2.trainingStats.AverageReward R5S20ROI2.trainingStats.AverageReward],2);
rewS20ROI4 = mean([R1S20ROI4.trainingStats.AverageReward R2S20ROI4.trainingStats.AverageReward R3S20ROI4.trainingStats.AverageReward R4S20ROI4.trainingStats.AverageReward R5S20ROI4.trainingStats.AverageReward],2);
rewS20ROI6 = mean([R1S20ROI6.trainingStats.AverageReward R2S20ROI6.trainingStats.AverageReward R3S20ROI6.trainingStats.AverageReward R4S20ROI6.trainingStats.AverageReward R5S20ROI6.trainingStats.AverageReward],2);

plot(steps,rewS20ROI0,steps, rewS20ROI2, steps,rewS20ROI4, steps,rewS20ROI6)
plot(steps,rewS20ROI0,steps, rewS20ROI2)%, steps,rewS20ROI4, steps,rewS20ROI6)

%%
plot(steps, R1S20ROI0.trainingStats.AverageReward, steps, R1S20ROI6.trainingStats.AverageReward)

%% S20 experiments
R1S20ROI0 = load("Run_1_Size_20_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R2S20ROI0 = load("Run_2_Size_20_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R3S20ROI0 = load("Run_3_Size_20_ROI_0_DyEnd_1_DyStart_1_stats.mat");

R1S20ROI1 = load("Run_1_Size_20_ROI_1_DyEnd_1_DyStart_1_stats.mat");
R2S20ROI1 = load("Run_2_Size_20_ROI_1_DyEnd_1_DyStart_1_stats.mat");
R3S20ROI1 = load("Run_3_Size_20_ROI_1_DyEnd_1_DyStart_1_stats.mat");

R1S20ROI2 = load("Run_1_Size_20_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R2S20ROI2 = load("Run_2_Size_20_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R3S20ROI2 = load("Run_3_Size_20_ROI_2_DyEnd_1_DyStart_1_stats.mat");

R1S20ROI4 = load("Run_1_Size_20_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R2S20ROI4 = load("Run_2_Size_20_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R3S20ROI4 = load("Run_3_Size_20_ROI_4_DyEnd_1_DyStart_1_stats.mat");

R1S20ROI6 = load("Run_1_Size_20_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R2S20ROI6 = load("Run_2_Size_20_ROI_6_DyEnd_1_DyStart_1_stats.mat");
R3S20ROI6 = load("Run_3_Size_20_ROI_6_DyEnd_1_DyStart_1_stats.mat");

%% S20 plots from LargeDataLogs

steps = 1:length(R1S20ROI0.trainingStats.AverageReward);

Rew0 = mean([R1S20ROI0.trainingStats.AverageReward, R2S20ROI0.trainingStats.AverageReward, R3S20ROI0.trainingStats.AverageReward],2);
Rew1 = mean([R1S20ROI1.trainingStats.AverageReward, R2S20ROI1.trainingStats.AverageReward, R3S20ROI1.trainingStats.AverageReward],2);
Rew2 = mean([R1S20ROI2.trainingStats.AverageReward, R2S20ROI2.trainingStats.AverageReward, R3S20ROI2.trainingStats.AverageReward],2);
Rew4 = mean([R1S20ROI4.trainingStats.AverageReward, R2S20ROI4.trainingStats.AverageReward, R3S20ROI4.trainingStats.AverageReward],2);
Rew6 = mean([R1S20ROI6.trainingStats.AverageReward, R2S20ROI6.trainingStats.AverageReward, R3S20ROI6.trainingStats.AverageReward],2);
%%
plot(steps, Rew2, steps, Rew4)

%%
R1S10ROI0 = load("Plots+_Run_1_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R2S10ROI0 = load("Plots+_Run_2_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R3S10ROI0 = load("Plots+_Run_3_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R4S10ROI0 = load("Plots+_Run_4_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R5S10ROI0 = load("Plots+_Run_5_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");

R1S10ROI4 = load("Plots+_Run_1_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R2S10ROI4 = load("Plots+_Run_2_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R3S10ROI4 = load("Plots+_Run_3_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R4S10ROI4 = load("Plots+_Run_4_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R5S10ROI4 = load("Plots+_Run_5_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");

steps = 1:250;

plot(steps,mean([R1S10ROI0.trainingStats.AverageReward R2S10ROI0.trainingStats.AverageReward R3S10ROI0.trainingStats.AverageReward R4S10ROI0.trainingStats.AverageReward R5S10ROI0.trainingStats.AverageReward],2),...
     steps,mean([R1S10ROI4.trainingStats.AverageReward R1S10ROI4.trainingStats.AverageReward R3S10ROI4.trainingStats.AverageReward R4S10ROI4.trainingStats.AverageReward R5S10ROI4.trainingStats.AverageReward],2));

% plot(steps, R5S10ROI0.trainingStats.AverageReward, steps, R5S10ROI4.trainingStats.AverageReward)

%% Long runs
R1S10ROI0 = load("LongRun_1_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R2S10ROI0 = load("LongRun_2_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R3S10ROI0 = load("LongRun_3_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");

R1S10ROI4 = load("LongRun_1_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R2S10ROI4 = load("LongRun_2_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");
R3S10ROI4 = load("LongRun_3_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");


steps = 1:1500;
figure(1)
plot(steps, R1S10ROI0.trainingStats.AverageReward, steps, R1S10ROI4.trainingStats.AverageReward);
figure(2)
plot(steps, R2S10ROI0.trainingStats.AverageReward, steps, R2S10ROI4.trainingStats.AverageReward);
figure(3)
plot(steps, R3S10ROI0.trainingStats.AverageReward, steps, R3S10ROI4.trainingStats.AverageReward);
figure(4)
plot(steps,mean([R1S10ROI0.trainingStats.AverageReward R2S10ROI0.trainingStats.AverageReward R3S10ROI0.trainingStats.AverageReward],2),...
     steps,mean([R1S10ROI4.trainingStats.AverageReward R2S10ROI4.trainingStats.AverageReward R3S10ROI4.trainingStats.AverageReward],2));

 
% plot(steps, R5S10ROI0.trainingStats.AverageReward, steps, R5S10ROI4.trainingStats.AverageReward)

%% S10 with Obs, long runs
R1S10ROI0 = load("ObsRun_1_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R1S10ROI2 = load("ObsRun_1_Size_10_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R1S10ROI4 = load("ObsRun_1_Size_10_ROI_4_DyEnd_1_DyStart_1_stats.mat");


steps = 1:1500;
figure(1)
plot(steps, R1S10ROI0.trainingStats.AverageReward, steps, R1S10ROI2.trainingStats.AverageReward);
figure(2)
plot(steps, R1S10ROI0.trainingStats.AverageReward, steps, R1S10ROI4.trainingStats.AverageReward);
figure(3)
plot(steps, R1S10ROI2.trainingStats.AverageReward, steps, R1S10ROI4.trainingStats.AverageReward);

%% S10 without Obs, long runs
R1S10ROI0 = load("Fixed_Run_1_Size_10_ROI_0_DyEnd_1_DyStart_1_stats.mat");
R1S10ROI2 = load("Fixed_Run_1_Size_10_ROI_2_DyEnd_1_DyStart_1_stats.mat");
R1S10ROI3 = load("Fixed_Run_1_Size_10_ROI_3_DyEnd_1_DyStart_1_stats.mat");


steps = 1:500;
figure(1)
plot(steps, R1S10ROI0.trainingStats.AverageReward, steps, R1S10ROI2.trainingStats.AverageReward);
figure(2)
plot(steps, R1S10ROI0.trainingStats.AverageReward, steps, R1S10ROI3.trainingStats.AverageReward);
figure(3)
plot(steps, R1S10ROI2.trainingStats.AverageReward, steps, R1S10ROI3.trainingStats.AverageReward);

%% SMC Paper visualization

Obs4 = load("SMC_FlatState_Obs2_Size_4_DyEnd_1_DyStart_1_stats.mat");
NoObs4 = load("SMC_FlatState_NoObs2_Size_4_DyEnd_1_DyStart_1_stats.mat");

figure(1)
plot(Obs4.trainingStats.AverageReward)
figure(2)
plot(NoObs4.trainingStats.AverageReward)
hold off
title("Training Process")
xlabel("Episode Number")
ylabel("Average Reward")
